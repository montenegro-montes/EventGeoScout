# Cargar la librería ggplot2
library(ggplot2)

# Definir las series Ratiot y Random
Ratiot <- c(19600000,	19600000,	19600000,	18700000,	18700000,	18600000,	18100000,	18100000,	18100000,	18000000,	17900000,	17800000,	17800000,	17800000,	17800000,	17700000,	17700000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	17400000,	18600000,	18600000,	18500000,	18500000,	18500000,	18300000,	18300000,	17700000,	17700000,	17700000,	17700000,	17200000	)
Random <- c(66400000,	66400000,	65300000,	63200000,	61800000,	59900000,	58300000,	55700000,	52400000,	48700000,	47200000,	44800000,	44800000,	43000000,	41600000,	41200000,	38300000,	38200000,	38000000,	37000000,	35900000,	34000000,	32800000,	32800000,	30700000,	29400000,	29300000,	27700000,	27400000,	25900000,	25900000,	25800000,	24700000,	24700000,	24700000,	23800000,	23800000,	23500000,	23300000,	22700000,	21100000,	21100000,	20200000,	20100000,	20100000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18700000,	18400000,	18400000,	18400000,	18400000,	18400000,	18400000,	18400000,	18400000,	18400000,	18400000,	18400000,	18300000,	18300000,	18300000,	18300000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18200000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	18000000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17300000,	17200000)

# Crear dataframes
data1 <- data.frame(
  Generaciones = 1:length(Ratiot),
  Valor = Ratiot,
  Series = "Ratio t"
)

data2 <- data.frame(
  Generaciones = 1:length(Random),
  Valor = Random,
  Series = "Random"
)

# Encuentra los valores mínimos en ambas series
min_value_Ratiot <- min(Ratiot)
min_value_Random <- min(Random)
length_Ratiot <- length(Ratiot)
length_Random <- length(Random)

# Combinar los dataframes
combined_data <- rbind(data1, data2)

# Crear la gráfica
plot <- ggplot(combined_data, aes(x = Generaciones, y = Valor, color = Series)) +
  geom_line() +
  labs(x = "Generations",y = "Fitness function Values") +
  scale_color_manual(values = c("Ratio t" = "green", "Random" = "red")) +
  theme(legend.position = "bottom")+ # Colocar la leyenda en la parte inferior
  ggtitle("Initial Population Generation Methods Comparison") + theme(plot.title = element_text(hjust = 0.5))+
  scale_y_continuous(labels = scales::label_number(drop0trailing = T, big.mark = ""))+
  
  annotate("text", x = 100, y = min_value_Ratiot, 
         label = paste("Generation Ratio t:    ", length_Ratiot), vjust = -9, hjust = 0)+
  annotate("text", x = 100, y = min_value_Ratiot, 
           label = paste("Generation Random: ", length_Random), vjust = -11, hjust = 0)+
  annotate("text", x = 100, y = min_value_Ratiot, 
           label = paste("Min. Fitness:    ", min_value_Ratiot), vjust = -13, hjust =  0)



plot <- plot 

# Mostrar la gráfica
print(plot)
